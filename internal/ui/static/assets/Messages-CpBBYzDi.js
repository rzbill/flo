import{k,r as i,V as F,$ as U,a0 as Q,a1 as W,a2 as Z,j as e,C as d,d as l,S as K,s as X,t as Y,u as ee,v as se,a3 as ae,I as te,A as de,D as le,E as b,G as y,a as w,b as _,J as h}from"./index-Dl3YmGhg.js";import{C as q}from"./clock-zV5i9vLz.js";import{U as re}from"./users-DqUlc2N1.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],ne=k("file-text",ie);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"m16 16 2 2 4-4",key:"gfu2re"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]],C=k("package-check",ce);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"M12 22v-9",key:"x3hkom"}],["path",{d:"M15.17 2.21a1.67 1.67 0 0 1 1.63 0L21 4.57a1.93 1.93 0 0 1 0 3.36L8.82 14.79a1.655 1.655 0 0 1-1.64 0L3 12.43a1.93 1.93 0 0 1 0-3.36z",key:"2ntwy6"}],["path",{d:"M20 13v3.87a2.06 2.06 0 0 1-1.11 1.83l-6 3.08a1.93 1.93 0 0 1-1.78 0l-6-3.08A2.06 2.06 0 0 1 4 16.87V13",key:"1pmm1c"}],["path",{d:"M21 12.43a1.93 1.93 0 0 0 0-3.36L8.83 2.2a1.64 1.64 0 0 0-1.63 0L3 4.57a1.93 1.93 0 0 0 0 3.36l12.18 6.86a1.636 1.636 0 0 0 1.63 0z",key:"12ttoo"}]],R=k("package-open",oe);function ue({namespace:u,workqueue:j}){const[n,p]=i.useState("ready"),[N,I]=i.useState("default"),[t,O]=i.useState(""),[f]=i.useState(100),{formatNumber:g,formatRelativeTime:v,formatBytes:V}=F(),{data:L}=U(u,j),E=i.useMemo(()=>L?.groups||["default"],[L]),{data:o,isLoading:H}=Q(u,j,0,f,!0),{data:m,isLoading:z}=W(u,j,N,f),{data:x,isLoading:A}=Z(u,j,N,0,f),M=o?.messages?.length||0,S=m?.entries?.length||0,D=x?.entries?.length||0,T=i.useMemo(()=>{if(!o?.messages)return[];if(!t)return o.messages;const s=t.toLowerCase();return o.messages.filter(a=>a.id_b64?.toLowerCase().includes(s)||a.seq.toString().includes(s)||JSON.stringify(a.payload||"").toLowerCase().includes(s))},[o,t]),$=i.useMemo(()=>{if(!m?.entries)return[];if(!t)return m.entries;const s=t.toLowerCase();return m.entries.filter(a=>a.id_b64?.toLowerCase().includes(s)||a.consumer_id.toLowerCase().includes(s))},[m,t]),P=i.useMemo(()=>{if(!x?.entries)return[];if(!t)return x.entries;const s=t.toLowerCase();return x.entries.filter(a=>a.id_b64?.toLowerCase().includes(s)||a.consumer_id.toLowerCase().includes(s))},[x,t]),B=()=>H?e.jsx("div",{className:"p-6 text-center text-muted-foreground",children:"Loading..."}):T.length===0?e.jsx(d,{children:e.jsx(l,{className:"pt-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(R,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Ready Messages"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t?"No messages match your search.":"Queue is empty."})]})})}):e.jsx("div",{className:"space-y-3",children:T.map(s=>{let a=s.payload||"";try{const r=JSON.parse(s.payload||"{}");a=JSON.stringify(r,null,2)}catch{}return e.jsxs(d,{children:[e.jsx(w,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs(_,{className:"text-sm font-mono truncate flex items-center gap-2",children:[e.jsx(ne,{className:"h-4 w-4 flex-shrink-0"}),e.jsxs("span",{className:"truncate",children:["Seq: ",s.seq]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["ID: ",s.id_b64||"N/A"]})]}),e.jsxs(h,{variant:"default",className:"flex-shrink-0 ml-2",children:["Priority: ",s.priority]})]})}),e.jsxs(l,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-muted-foreground mb-1",children:"Partition"}),e.jsx("div",{className:"font-semibold",children:s.partition})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted-foreground mb-1",children:"Size"}),e.jsx("div",{className:"font-semibold",children:V(s.payload_size)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted-foreground mb-1",children:"Delay"}),e.jsx("div",{className:"font-semibold",children:s.delay_until_ms>Date.now()?`${Math.floor((s.delay_until_ms-Date.now())/1e3)}s`:"None"})]})]}),s.payload&&e.jsxs("div",{className:"pt-2 border-t",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-2",children:"Payload"}),e.jsx("pre",{className:"text-xs bg-muted p-2 rounded overflow-x-auto max-h-48 overflow-y-auto",children:a})]}),s.headers&&Object.keys(s.headers).length>0&&e.jsxs("div",{className:"pt-2 border-t",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-2",children:"Headers"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:Object.entries(s.headers).map(([r,c])=>e.jsxs(h,{variant:"outline",className:"text-xs",children:[r,": ",c]},r))})]})]})]},`${s.seq}-${s.id_b64}`)})}),G=()=>z?e.jsx("div",{className:"p-6 text-center text-muted-foreground",children:"Loading..."}):$.length===0?e.jsx(d,{children:e.jsx(l,{className:"pt-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(q,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Pending Messages"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t?"No messages match your search.":"No messages are currently being processed."})]})})}):e.jsx("div",{className:"space-y-3",children:$.map(s=>{const a=new Date(s.lease_expires_at_ms),r=Date.now(),c=a.getTime()-r;return e.jsxs(d,{children:[e.jsx(w,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs(_,{className:"text-sm font-mono truncate flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:s.consumer_id})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["ID: ",s.id_b64||s.id]})]}),e.jsx(h,{variant:c>0?"default":"destructive",className:"flex-shrink-0 ml-2",children:c>0?"Active":"Expired"})]})}),e.jsxs(l,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-muted-foreground mb-1",children:"Delivery Count"}),e.jsx("div",{className:"font-semibold",children:s.delivery_count})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted-foreground mb-1",children:"Idle Time"}),e.jsxs("div",{className:"font-semibold",children:[Math.floor(s.idle_ms/1e3),"s"]})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Last Delivery"}),e.jsx("span",{className:"font-medium",children:v(s.last_delivery_ms)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Lease Expires"}),e.jsx("span",{className:"font-medium",children:c>0?`in ${Math.floor(c/1e3)}s`:"Expired"})]})]})]})]},`${s.id_b64}-${s.consumer_id}`)})}),J=()=>A?e.jsx("div",{className:"p-6 text-center text-muted-foreground",children:"Loading..."}):P.length===0?e.jsx(d,{children:e.jsx(l,{className:"pt-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(C,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Completed Messages"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t?"No messages match your search.":"No messages have been completed yet."})]})})}):e.jsx("div",{className:"space-y-3",children:P.map(s=>e.jsxs(d,{children:[e.jsx(w,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs(_,{className:"text-sm font-mono truncate flex items-center gap-2",children:[e.jsx(C,{className:"h-4 w-4 flex-shrink-0"}),e.jsxs("span",{className:"truncate",children:["Seq: ",s.seq]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["By: ",s.consumer_id]})]}),e.jsxs(h,{variant:"secondary",className:"flex-shrink-0 ml-2",children:[s.delivery_count,"x delivered"]})]})}),e.jsxs(l,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-muted-foreground mb-1",children:"Duration"}),e.jsxs("div",{className:"font-semibold",children:[(s.duration_ms/1e3).toFixed(2),"s"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted-foreground mb-1",children:"Partition"}),e.jsx("div",{className:"font-semibold",children:s.partition})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Completed"}),e.jsx("span",{className:"font-medium",children:v(s.completed_at_ms)})]}),s.dequeued_at_ms>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Dequeued"}),e.jsx("span",{className:"font-medium",children:v(s.dequeued_at_ms)})]})]}),s.headers&&Object.keys(s.headers).length>0&&e.jsxs("div",{className:"pt-2 border-t",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-2",children:"Headers"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:Object.entries(s.headers).map(([a,r])=>e.jsxs(h,{variant:"outline",className:"text-xs",children:[a,": ",r]},a))})]})]})]},`${s.seq}-${s.id_b64}`))});return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Messages"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"View messages across different lifecycle states"})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(d,{className:`cursor-pointer transition-all ${n==="ready"?"ring-2 ring-primary":""}`,onClick:()=>p("ready"),children:e.jsxs(l,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"🟢 Ready"}),e.jsx("p",{className:"text-2xl font-bold",children:g(M)})]}),e.jsx(R,{className:"h-8 w-8 text-green-500"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Waiting to be dequeued"})]})}),e.jsx(d,{className:`cursor-pointer transition-all ${n==="pending"?"ring-2 ring-primary":""}`,onClick:()=>p("pending"),children:e.jsxs(l,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"🟡 Pending"}),e.jsx("p",{className:"text-2xl font-bold",children:g(S)})]}),e.jsx(q,{className:"h-8 w-8 text-yellow-500"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Being processed"})]})}),e.jsx(d,{className:`cursor-pointer transition-all ${n==="completed"?"ring-2 ring-primary":""}`,onClick:()=>p("completed"),children:e.jsxs(l,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"🔵 Completed"}),e.jsx("p",{className:"text-2xl font-bold",children:g(D)})]}),e.jsx(C,{className:"h-8 w-8 text-blue-500"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Recently finished"})]})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[(n==="pending"||n==="completed")&&e.jsx("div",{className:"shrink-0",children:e.jsxs(K,{value:N,onValueChange:I,children:[e.jsx(X,{className:"w-[180px] h-8 hover:bg-input-background active:bg-input data-[state=open]:bg-input",children:e.jsxs("span",{className:"flex items-center gap-1 text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"group"}),e.jsx("span",{className:"inline-block w-1","aria-hidden":!0}),e.jsx(Y,{})]})}),e.jsx(ee,{children:E.map(s=>e.jsx(se,{value:s,className:"text-xs",children:s},s))})]})}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ae,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(te,{placeholder:"Search by ID, consumer, or content...",value:t,onChange:s=>O(s.target.value),className:"pl-9"})]})]}),e.jsxs(de,{value:n,onValueChange:s=>p(s),children:[e.jsxs(le,{className:"grid w-full grid-cols-3",children:[e.jsxs(b,{value:"ready",children:["Ready (",M,")"]}),e.jsxs(b,{value:"pending",children:["Pending (",S,")"]}),e.jsxs(b,{value:"completed",children:["Completed (",D,")"]})]}),e.jsx(y,{value:"ready",className:"mt-6",children:B()}),e.jsx(y,{value:"pending",className:"mt-6",children:G()}),e.jsx(y,{value:"completed",className:"mt-6",children:J()})]})]})}export{ue as default};
